<!DOCTYPE html>
<html lang="z">
<head>
    <meta charset="utf-8"/>
    <meta http-equiv="X-UA-Compatible" content="IE=edge"/>
    
    <title>Storyboard的爱与恨（上） | PPPan&#39;s 平凡之路</title>
    <meta name="renderer" content="webkit">
    <meta name="HandheldFriendly" content="True">
    <meta name="MobileOptimized" content="320">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">

    <meta name="description" content="PPPan&#39;s 平凡之路 一个技术博客覆盖范围包括 iOS Objecticve-C Swift Xcode 等">

    <meta name="twitter:card" content="summary">
    <meta name="twitter:title" content="Storyboard的爱与恨（上） | PPPan&#39;s 平凡之路">
    <meta name="twitter:description" content="PPPan&#39;s 平凡之路 一个技术博客覆盖范围包括 iOS Objecticve-C Swift Xcode 等">

    <meta property="og:type" content="article">
    <meta property="og:title" content="Storyboard的爱与恨（上） | PPPan&#39;s 平凡之路">
    <meta property="og:description" content="PPPan&#39;s 平凡之路 一个技术博客覆盖范围包括 iOS Objecticve-C Swift Xcode 等">

    
    <meta name="author" content="PPPan">
    
    <link rel="stylesheet" href="../css/vno.css">
    <link rel="stylesheet" href="//netdna.bootstrapcdn.com/font-awesome/4.1.0/css/font-awesome.min.css">

    
    <link rel="icon" href="/images/favicon.png">
    

    <meta name="generator" content="hexo"/>
    
    <link rel="alternate" type="application/rss+xml" title="PPPan&#39;s 平凡之路" href="/atom.xml">
    

    <link rel="canonical" href="https://shengpan.net/storyboard/"/>

                 
</head>

<body class="home-template no-js">
    <script src="//cdn.bootcss.com/jquery/2.1.4/jquery.min.js"></script>
    <script src="../js/main.js"></script>
    <span class="mobile btn-mobile-menu">
        <i class="fa fa-list btn-mobile-menu__icon"></i>
        <i class="fa fa-angle-up btn-mobile-close__icon hidden"></i>
    </span>

    
<header class="panel-cover panel-cover--collapsed" style="background-image: url(/images/background-cover.jpg)">
  <div class="panel-main">
    <div class="panel-main__inner panel-inverted">
    <div class="panel-main__content">

        <a href="/" title="前往 PPPan&#39;s 平凡之路 的主页"><img src="/images/avatar.jpg" width="80" alt="PPPan&#39;s 平凡之路 logo" class="panel-cover__logo logo" /></a>
        <h1 class="panel-cover__title panel-title"><a href="/" title="link to homepage for PPPan&#39;s 平凡之路">PPPan&#39;s 平凡之路</a></h1>
        
        <span class="panel-cover__subtitle panel-subtitle">做一个互联网内容的贡献者</span>
        
        <hr class="panel-cover__divider" />
        <p class="panel-cover__description">PPPan's 平凡之路 一个技术博客覆盖范围包括 iOS Objecticve-C Swift Xcode 等</p>
        <hr class="panel-cover__divider panel-cover__divider--secondary" />

        <div class="navigation-wrapper">
          <div>
          <nav class="cover-navigation cover-navigation--primary">
            <ul class="navigation">
              <li class="navigation__item"><a href="/#blog" title="Visit the blog" class="blog-button">Blog</a></li>
            
              <li class="navigation__item"><a href="https://github.com/DeveloperPans">GitHub</a></li>
            
            </ul>
          </nav>
          </div>
          <div>
          <nav class="cover-navigation navigation--social">
  <ul class="navigation">

  <!-- Weibo-->
  
  <li class="navigation__item">
    <a href="http://weibo.com/u/5666355111" title="Weibo" target="_blank">
      <i class='social fa fa-weibo'></i>
      <span class="label">Weibo</span>
    </a>
  </li> 


  <!-- Github -->
  
  <li class="navigation__item">
    <a href="https://github.com/DeveloperPans" title="GitHub" target="_blank">
      <i class='social fa fa-github'></i>
      <span class="label">Github</span>
    </a>
  </li>


<!-- Stack Overflow -->
        

  <!-- Google Plus -->
  

<!-- Facebook -->

  
<!-- Twitter -->

  <li class="navigation__item">
    <a href="https://twitter.com/developerpans" title="Twitter" target="_blank">
      <i class='social fa fa-twitter'></i>
      <span class="label">Twitter</span>
    </a>
  </li>

  

  <li class="navigation__item">
    <a href="/atom.xml" title="RSS" target="_blank">
      <i class='social fa fa-rss'></i>
      <span class="label">RSS</span>
    </a>
  </li>



  </ul>
</nav>

          </div>
        </div>

      </div>

    </div>

    <div class="panel-cover--overlay cover-blue"></div>
  </div> 
</header>

    <div class="content-wrapper">
        <div class="content-wrapper__inner">
            <article class="post-container post-container--single">

  <header class="post-header">
    <div class="post-meta">
      <time datetime="2016-02-01T22:30:53.000Z" class="post-list__meta--date date">2016-02-02</time> &#8226; <span class="post-meta__tags tags">于  </span>
      <span class="page-pv">
       Read <span id="busuanzi_value_page_pv"><i class="fa fa-spinner fa-spin"></i></span>
      </span> 
   
    </div>
    <h1 class="post-title">Storyboard的爱与恨（上）</h1>
  </header>

  <section class="post">
    <p>尽管现在已经是Apple将Storyboard整合进Xcode中的第四个年头，大家对于Storyboard的评价仍然褒贬不一。<a href="http://onevcat.com/2013/12/code-vs-xib-vs-storyboard/" target="_blank" rel="noopener">有早期就选择转向Storyboard</a>用于UI开发的国内业界领头人物，也有<a href="http://martinnormark.com/the-story-of-no-storyboard-in-ios-development/" target="_blank" rel="noopener">创建项目就立马删除Storyboard</a>的大牛。我经历过纯代码布局，同时也在多个多人合作项目中使用Storyboard开发界面。在初期绕过各种坑后，Storyboard将会是快速构建UI界面的好帮手，特别是在现如今设备分辨率与尺寸日益增加的情况下，它可以帮助工程师们节约大量的界面代码书写时间。Storyboard存在的一大意义在于为UI提供了可视化开发方式，另一方面提供了一种更好的MVC的View层实现方式，让你的ViewController代码更简洁。当然，Storyboard的不足仍然不可忽视，错误的难以定位经常让刚上手的开发者们手足无措，相比于代码更不容易阅读的XML源文件所导致多人合作中的冲突不易解决等问题仍然有待完善。本文从各个方面介绍一下Storyboard，分享一下Storyboard的一些使用心得。</p>
<h3 id="历史"><a href="#历史" class="headerlink" title="历史"></a>历史</h3><p>1986年Jean-Marie Hullot发明了IB(Interface Build–Storyboard的前身),并且和Macintosh的工具箱无缝融合，这一工具被Denison Bollay发现了。第二年， Denison Bollay带着Hullot和他的IB到NeXT,将IB演示给Steve Jobs看。老乔立意识到了IB的价值，并将其纳入到了NeXTSTEP中。之后Steve 带着NeXT的技术结晶(当然也包括IB)重新回归Apple，并将之整合到了Apple的体系中。2008年第一代iPhone SDK发布的时候，IB就已经捆绑在其中。到了Xcode4,Apple更是直接将其集成进IDE里。随后随着不断地改进，更新，演变，最终变成了我们今天所看到的Storyboard。从某种角度来说，Storyboard也是老乔留给我们的众多礼物之一。</p>
<h3 id="故事板能做什么"><a href="#故事板能做什么" class="headerlink" title="故事板能做什么"></a>故事板能做什么</h3><p>故事板主要为我们提供了以下的功能：(这些功能都是<strong>可视化</strong>的)</p>
<ul>
<li>Auto Layout</li>
<li>Size Classes</li>
<li>Secnce的跳转 </li>
<li>代码可视化</li>
</ul>
<h4 id="Auto-Layout"><a href="#Auto-Layout" class="headerlink" title="Auto Layout"></a>Auto Layout</h4><p>自动布局颠覆了之前直接操作Frame的布局方式，从思考<strong>View应该在哪个位置</strong>,变成了考虑<strong>在特定条件下，View的所处的位置需要满足哪些条件</strong>。通过这些条件来确定View的Frame。自动布局在实际应用中大体上可以将分为三组:</p>
<p><strong>View与Super View的约束</strong></p>
<p><img src="/content/images/2016/02/-----2016-02-19-15-27-33.png" alt=""></p>
<p><strong>View自身的约束</strong></p>
<p><img src="/content/images/2016/02/-----2016-02-19-15-27-47-2.png" alt=""></p>
<p><strong>View与Other View的约束</strong></p>
<p><img src="/content/images/2016/02/-----2016-02-19-15-27-58-2-1.png" alt=""></p>
<p>假如我们需要在代码中使用自动布局可以使用<br><a href="https://developer.apple.com/library/ios/documentation/UserExperience/Conceptual/AutolayoutPG/VisualFormatLanguage.html" target="_blank" rel="noopener">Visual Format Language</a>或者<code>NSLayoutConstraint</code>的简单工厂方法来生成约束，然后添加到View上。我们来看一个例子：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line">//用代码来实现上图中View与Super View的约束</span><br><span class="line">    UIView *superView = self.view;</span><br><span class="line">    UIView *subView = [[UIView alloc] init];</span><br><span class="line">    NSLayoutConstraint *leadingConstraint = [NSLayoutConstraint constraintWithItem:superView</span><br><span class="line">                                                           attribute:NSLayoutAttributeLeading</span><br><span class="line">                                                           relatedBy:NSLayoutRelationEqual</span><br><span class="line">                                                              toItem:subView</span><br><span class="line">                                                           attribute:NSLayoutAttributeLeading</span><br><span class="line">                                                          multiplier:1</span><br><span class="line">                                                            constant:15];</span><br><span class="line">    NSLayoutConstraint *TrailingConstraint = [NSLayoutConstraint constraintWithItem:superView</span><br><span class="line">                                                                         attribute:NSLayoutAttributeTrailing</span><br><span class="line">                                                                         relatedBy:NSLayoutRelationEqual</span><br><span class="line">                                                                            toItem:subView</span><br><span class="line">                                                                         attribute:NSLayoutAttributeTrailing</span><br><span class="line">                                                                        multiplier:1</span><br><span class="line">                                                                          constant:15];</span><br><span class="line"></span><br><span class="line">//topConstraint init...</span><br><span class="line">//bottomConstraint init...</span><br><span class="line">    [superView addConstraint:leadingConstraint];</span><br><span class="line">    [superView addConstraint:TrailingConstraint];</span><br><span class="line">    [superView addConstraint:topConstraint];</span><br><span class="line">    [superView addConstraint:bottomConstraint];</span><br><span class="line">    </span><br><span class="line">    // 如果是iOS8+ 则使用下面的方式来激活Constraint</span><br><span class="line">    // leadingConstraint.active = YES;</span><br><span class="line">    // leadingConstraint.active = YES;</span><br><span class="line">    // leadingConstraint.active = YES;</span><br><span class="line">    // leadingConstraint.active = YES;</span><br></pre></td></tr></table></figure>
<p>是不是一大团乱糟糟的代码?Visual Format Language用起来更加令人崩溃。好在业界已经有比较好的代码自动布局的<a href="https://github.com/SnapKit/Masonry" target="_blank" rel="noopener">第三方解决方案</a>。但是仍然会有大堆的简单界面布局代码残留在你的代码中。</p>
<p>为了让你的生活更轻松(也为了让代码更清爽)，Storyboard就包含了非常优雅的可视化自动布局解决方案。以上一切，在Storyboard中都被浓缩成了两个按钮（下图红圈中的椭圆按钮）。</p>
<p><img src="/content/images/2016/02/1111.png" alt=""></p>
<ul>
<li>红框1:为被选中View和离他最近的View(可能是SuperView,也可能是另一个同层级的View,看哪个离它更近)添加Leading、Training、Top、Bottom四个属性约束。</li>
<li>红框2:为View添加自身宽和高约束</li>
<li>红色椭圆左侧按钮:当选中多个View时，为多个View添加约束</li>
</ul>
<p>只需要点击几下鼠标，Storyboard就可以帮你轻松完成视图布局。</p>
<h4 id="Auto-Layout-Debug"><a href="#Auto-Layout-Debug" class="headerlink" title="Auto Layout Debug"></a>Auto Layout Debug</h4><p>使用代码来对Auto Layout布局的另一个缺点在于debug的困难。当添加了多余的约束，往往只能在运行时才能发现错误。同时，要寻找出是哪一行代码添加了错误的约束也比较费力(往往连控制台都没有错误输出)。</p>
<p>而Storyboard却为此提供了非常友好的静态检查。主要针对View的约束、布局提供警告和Error,甚至是解决方案。</p>
<p><img src="/content/images/2016/02/-----2016-02-19-16-30-51.png" alt=""></p>
<p>上图的例子是：我们为Label添加了多余的约束，Storyboard用红色标记出冲突的约束，并给出修改建议:<em>删除其中一个约束以保证约束的正确性。</em>是不是很友好？ ：）</p>
<h4 id="Size-Classes"><a href="#Size-Classes" class="headerlink" title="Size Classes"></a>Size Classes</h4><p>Apple 与iOS 8推出了Size Classes的概念。意在解决因设备尺寸造成的适配问题。Size Classes通过将界面的宽度和高度抽象为<code>正常</code>和<code>紧凑</code>两种概念，通过合理的组合，可以将现有设备(以及未来将要出现的设备)划分到不同的Size中。因此，无论是代码还是界面布局，只需要针对Size进行，而不用再拘泥于分辨是iPhone还是iPad,是横屏还是竖屏的问题了。Size Classes的推出是具有前瞻性的，无论是Apple Watch还是iOS 9推出的的iPad 分屏模式，都可以用Size Classes完美解决适配的问题。</p>
<p>Size Classes和现有设备的对照表如下：</p>
<p><img src="/content/images/2016/02/-----2016-02-19-16-50-33.png" alt=""></p>
<p>在之前，我们要对横屏竖屏的界面进行区分，代码一般是这样的：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">if (IPAD_PORTRAIT)</span><br><span class="line">&#123;</span><br><span class="line">    //TODO:modify something portrait</span><br><span class="line">&#125;</span><br><span class="line">else</span><br><span class="line">&#123;</span><br><span class="line">    //TODO:modify something landscape</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>在Size Classes时代，Apple引入了一个新的类<code>UITraitCollection</code>来封装水平和垂直方向的Size信息。现在我们通过代码来改变界面是这样的：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">- (void)willTransitionToTraitCollection:(UITraitCollection *)newCollection </span><br><span class="line">              withTransitionCoordinator:(id &lt;UIViewControllerTransitionCoordinator&gt;)coordinator</span><br><span class="line">&#123;</span><br><span class="line">    [super willTransitionToTraitCollection:newCollection </span><br><span class="line">                 withTransitionCoordinator:coordinator];</span><br><span class="line">    [coordinator animateAlongsideTransition:^(id &lt;UIViewControllerTransitionCoordinatorContext&gt; context) </span><br><span class="line">    &#123;</span><br><span class="line">        if (newCollection.verticalSizeClass == UIUserInterfaceSizeClassCompact) &#123;</span><br><span class="line">            //To Do: modify something for compact vertical size</span><br><span class="line">        &#125; else &#123;</span><br><span class="line">            //To Do: modify something for other vertical size</span><br><span class="line">        &#125;</span><br><span class="line">        [self.view setNeedsLayout];</span><br><span class="line">    &#125; completion:nil];</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>在TODO中做相对应Size的事。</p>
<p>可以想见的是，仍然会有非常多的布局代码占据着你的源文件。但在Storyboard中，一切变得异常简单。</p>
<p>使用Size Classes，我们只需要选择相对应的size，在那个Size下进行布局。运行时，就会根据设备的尺寸，自动地展示相对应Size的布局。比如iPhone竖屏就展示<code>width Compact height Regular</code>Size下的信息。当手机横屏，系统会自动添加一个过渡动画(虽然有点生硬),并转到<code>width Regular height Compact</code>的Size。这一切不需要一行代码。</p>
<blockquote>
<p>能不能再给力点?</p>
</blockquote>
<p>Sure.有这么一种情景:<em>iPhone横屏下，拥有一个<code>avatarView</code>,竖屏下拥有一个相同的<code>avatar View</code></em>。这种情况下我们只需要在一个Size中完成这个View,然后在Storyboard的<code>attributed inspector</code>中做一些勾选，将其”install”进相对应的Size中，就可以达到复用的目的。如果有差异，则在对应的Size中定制即可。（如下图）</p>
<p><img src="/content/images/2016/02/-----2016-02-19-17-07-12-1.png" alt=""></p>
<blockquote>
<p>能不能再给力点儿？</p>
</blockquote>
<p>Of Course！除了View,约束也可以不同Size配置不同。最厉害的是，图片文件也可以根据Size来区分。我们只需要对<code>.xcassets</code>文件勾选Size Classes,就可以为不同Size配置不同图片.这意味着，在同一个安装包下，通过Size Classes，我们甚至可以为横屏iPhone和竖屏iPhone做出完全不同的App!</p>
<p><img src="/content/images/2016/02/-----2016-02-19-17-29-01.png" alt=""></p>
<p><a href="http://shengpan.net/storyboard2">Storyboard的爱与恨(下)</a></p>

  </section>

</article>

<section class="read-more">
           
    
               
            <div class="read-more-item">
                <span class="read-more-item-dim">Newer Post</span>
                <h2 class="post-list__post-title post-title"><a href="/storyboard2/" title="Storyboard的爱与恨（下）">Storyboard的爱与恨（下）</a></h2>
                <p class="excerpt">
                
                Scene的转场如我们所料，Storyboard也可以通过可视化的操作来实现Scene的转场。
故事板的转场有两种，可以分为手动触发和自动触发。自动触发完全由Storyboard实现，而手动触发则需要配合代码。前者简单易用，后者适用于配合业务逻辑，进行不同转场的触发。自动触发的转场非常简单，我们只需
                &hellip;
                </p>
                <div class="post-list__meta"><time datetime="2016-02-21T23:53:04.000Z" class="post-list__meta--date date">2016-02-22</time> &#8226; <span class="post-list__meta--tags tags">于 </span><a class="btn-border-small" href="/storyboard2/">继续阅读</a></div>
                           
            </div>
        
        
               
            <div class="read-more-item">
                <span class="read-more-item-dim">Older Post</span>
                <h2 class="post-list__post-title post-title"><a href="/app-store-review-guidelines/" title="App Store审核指南-中文版">App Store审核指南-中文版</a></h2>
                <p class="excerpt">
                
                出处本文原文来自Cocoachina.本文对其整理归纳，重点标注出开发者们不熟悉且容易触碰的雷区，并做了页内跳转的制作和格式的美化，以方便阅读和查询。
英文版文档原文为App Store Review Guidelines
前言感谢您付出宝贵的才华与时间来开发iOS应用程程序。从职业与报酬的角度而言
                &hellip;
                </p>
                <div class="post-list__meta"><time datetime="2016-01-23T23:26:37.000Z" class="post-list__meta--date date">2016-01-24</time> &#8226; <span class="post-list__meta--tags tags">于 </span><a class="btn-border-small" href="/app-store-review-guidelines/">继续阅读</a></div>
                       
            </div>
        
     
   
   
  
</section>

  

            <footer class="footer">
    <span class="footer__copyright">
        &copy; 2018 PPPan - 本站点采用 <a href="http://creativecommons.org/licenses/by-nc-sa/4.0/">知识共享署名-非商业性使用-相同方式共享 4.0 国际许可协议</a>
       
    </span>
    <span class="footer__copyright">
            基于 <a href="http://hexo.io">Hexo</a> 搭建，使用 <a href="https://github.com/monniya/hexo-theme-new-vno ">new-vno</a> 主题，由<a href="https://monniya.com ">@Monniya</a> 修改自 <a href="https://github.com/lenbo-ma/hexo-theme-vno" target="_blank">Vno</a>, 原创出自<a href="http://github.com/onevcat/vno" target="_blank">onevcat</a>
    </span>
    <span class="footer__copyright">
            <a href="http://www.miitbeian.gov.cn/">浙ICP备15035859号</a>
    </span>
    
    
</footer>


        </div>
    </div>

     
<script>
	(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
	(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
	m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
	})(window,document,'script','//www.google-analytics.com/analytics.js','ga');

	ga('create', 'UA-86796774-1', 'auto');
	ga('send', 'pageview');
</script>

    


    <script async src="https://dn-lbstatics.qbox.me/busuanzi/2.3/busuanzi.pure.mini.js"></script>
    
    
</body>
</html>
